Download Link: https://assignmentchef.com/product/solved-csci567-homework3-neural-networks
<br>
<h2 id="Neural-Networks-(40-points)">Neural Networks<img decoding="async" data-src="MLP_diagram.png" class="lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">

 <noscript>

  <img decoding="async" src="MLP_diagram.png">

 </noscript></h2>

For this assignment, you are asked to implement neural networks. You will use this neural network to classify MNIST database of handwritten digits (0-9). The architecture of the neural network you will implement is based on the multi-layer perceptron (MLP, just another term for fully connected feedforward networks we discussed in the lecture), which is shown as following. It is designed for a K-class classification problem.

Let <span id="MathJax-Element-1-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mi>D</mi></msup><mo>,</mo><mi>y</mi><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><mi>K</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mo stretchy=&quot;false&quot;>)</mo></math>"><span id="MathJax-Span-1" class="math"><span id="MathJax-Span-2" class="mrow"><span id="MathJax-Span-3" class="mo">(</span><span id="MathJax-Span-4" class="mi">x</span><span id="MathJax-Span-5" class="mo">∈</span><span id="MathJax-Span-6" class="msubsup"><span id="MathJax-Span-7" class="texatom"><span id="MathJax-Span-8" class="mrow"><span id="MathJax-Span-9" class="mi">R</span></span></span><span id="MathJax-Span-10" class="mi">D</span></span><span id="MathJax-Span-11" class="mo">,</span><span id="MathJax-Span-12" class="mi">y</span><span id="MathJax-Span-13" class="mo">∈</span><span id="MathJax-Span-14" class="mo">{</span><span id="MathJax-Span-15" class="mn">1</span><span id="MathJax-Span-16" class="mo">,</span><span id="MathJax-Span-17" class="mn">2</span><span id="MathJax-Span-18" class="mo">,</span><span id="MathJax-Span-19" class="mo">⋯</span><span id="MathJax-Span-20" class="mo">,</span><span id="MathJax-Span-21" class="mi">K</span><span id="MathJax-Span-22" class="mo">}</span><span id="MathJax-Span-23" class="mo">)</span></span></span><span class="MJX_Assistive_MathML" role="presentation">(x∈RD,y∈{1,2,⋯,K})</span></span> be a labeled instance, such an MLP performs the following computations:

For a <span id="MathJax-Element-3-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>"><span id="MathJax-Span-393" class="math"><span id="MathJax-Span-394" class="mrow"><span id="MathJax-Span-395" class="mi">K</span></span></span><span class="MJX_Assistive_MathML" role="presentation">K</span></span>-class classification problem, one popular loss function for training (i.e., to learn <span id="MathJax-Element-4-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>"><span id="MathJax-Span-396" class="math"><span id="MathJax-Span-397" class="mrow"><span id="MathJax-Span-398" class="msubsup"><span id="MathJax-Span-399" class="mi">W</span><span id="MathJax-Span-400" class="texatom"><span id="MathJax-Span-401" class="mrow"><span id="MathJax-Span-402" class="mo">(</span><span id="MathJax-Span-403" class="mn">1</span><span id="MathJax-Span-404" class="mo">)</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">W(1)</span></span>, <span id="MathJax-Element-5-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>"><span id="MathJax-Span-405" class="math"><span id="MathJax-Span-406" class="mrow"><span id="MathJax-Span-407" class="msubsup"><span id="MathJax-Span-408" class="mi">W</span><span id="MathJax-Span-409" class="texatom"><span id="MathJax-Span-410" class="mrow"><span id="MathJax-Span-411" class="mo">(</span><span id="MathJax-Span-412" class="mn">2</span><span id="MathJax-Span-413" class="mo">)</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">W(2)</span></span>, <span id="MathJax-Element-6-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>"><span id="MathJax-Span-414" class="math"><span id="MathJax-Span-415" class="mrow"><span id="MathJax-Span-416" class="msubsup"><span id="MathJax-Span-417" class="mi">b</span><span id="MathJax-Span-418" class="texatom"><span id="MathJax-Span-419" class="mrow"><span id="MathJax-Span-420" class="mo">(</span><span id="MathJax-Span-421" class="mn">1</span><span id="MathJax-Span-422" class="mo">)</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">b(1)</span></span>, <span id="MathJax-Element-7-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>"><span id="MathJax-Span-423" class="math"><span id="MathJax-Span-424" class="mrow"><span id="MathJax-Span-425" class="msubsup"><span id="MathJax-Span-426" class="mi">b</span><span id="MathJax-Span-427" class="texatom"><span id="MathJax-Span-428" class="mrow"><span id="MathJax-Span-429" class="mo">(</span><span id="MathJax-Span-430" class="mn">2</span><span id="MathJax-Span-431" class="mo">)</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">b(2)</span></span>) is the cross-entropy loss. Specifically we denote the cross-entropy loss with respect to the training example <span id="MathJax-Element-8-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>"><span id="MathJax-Span-432" class="math"><span id="MathJax-Span-433" class="mrow"><span id="MathJax-Span-434" class="mo">(</span><span id="MathJax-Span-435" class="mi">x</span><span id="MathJax-Span-436" class="mo">,</span><span id="MathJax-Span-437" class="mi">y</span><span id="MathJax-Span-438" class="mo">)</span></span></span><span class="MJX_Assistive_MathML" role="presentation">(x,y)</span></span> by <span id="MathJax-Element-9-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi></math>"><span id="MathJax-Span-439" class="math"><span id="MathJax-Span-440" class="mrow"><span id="MathJax-Span-441" class="mi">l</span></span></span><span class="MJX_Assistive_MathML" role="presentation">l</span></span>:

Note that one should look at <span id="MathJax-Element-11-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi></math>"><span id="MathJax-Span-484" class="math"><span id="MathJax-Span-485" class="mrow"><span id="MathJax-Span-486" class="mi">l</span></span></span><span class="MJX_Assistive_MathML" role="presentation">l</span></span> as a function of the parameters of the network, that is, <span id="MathJax-Element-12-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>"><span id="MathJax-Span-487" class="math"><span id="MathJax-Span-488" class="mrow"><span id="MathJax-Span-489" class="msubsup"><span id="MathJax-Span-490" class="mi">W</span><span id="MathJax-Span-491" class="texatom"><span id="MathJax-Span-492" class="mrow"><span id="MathJax-Span-493" class="mo">(</span><span id="MathJax-Span-494" class="mn">1</span><span id="MathJax-Span-495" class="mo">)</span></span></span></span><span id="MathJax-Span-496" class="mo">,</span><span id="MathJax-Span-497" class="msubsup"><span id="MathJax-Span-498" class="mi">b</span><span id="MathJax-Span-499" class="texatom"><span id="MathJax-Span-500" class="mrow"><span id="MathJax-Span-501" class="mo">(</span><span id="MathJax-Span-502" class="mn">1</span><span id="MathJax-Span-503" class="mo">)</span></span></span></span><span id="MathJax-Span-504" class="mo">,</span><span id="MathJax-Span-505" class="msubsup"><span id="MathJax-Span-506" class="mi">W</span><span id="MathJax-Span-507" class="texatom"><span id="MathJax-Span-508" class="mrow"><span id="MathJax-Span-509" class="mo">(</span><span id="MathJax-Span-510" class="mn">2</span><span id="MathJax-Span-511" class="mo">)</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">W(1),b(1),W(2)</span></span> and <span id="MathJax-Element-13-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>"><span id="MathJax-Span-512" class="math"><span id="MathJax-Span-513" class="mrow"><span id="MathJax-Span-514" class="msubsup"><span id="MathJax-Span-515" class="mi">b</span><span id="MathJax-Span-516" class="texatom"><span id="MathJax-Span-517" class="mrow"><span id="MathJax-Span-518" class="mo">(</span><span id="MathJax-Span-519" class="mn">2</span><span id="MathJax-Span-520" class="mo">)</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">b(2)</span></span>. For ease of notation, let us define the one-hot (i.e., 1-of-<span id="MathJax-Element-14-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>"><span id="MathJax-Span-521" class="math"><span id="MathJax-Span-522" class="mrow"><span id="MathJax-Span-523" class="mi">K</span></span></span><span class="MJX_Assistive_MathML" role="presentation">K</span></span>) encoding of a class <span id="MathJax-Element-15-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>"><span id="MathJax-Span-524" class="math"><span id="MathJax-Span-525" class="mrow"><span id="MathJax-Span-526" class="mi">y</span></span></span><span class="MJX_Assistive_MathML" role="presentation">y</span></span> as

so that

We can then perform error-backpropagation, a way to compute partial derivatives (or gradients) w.r.t the parameters of a neural network, and use gradient-based optimization to learn the parameters.

<h4 id="Submission:-You-need-to-submit-both-neural_networks.py-and-utils.py.">Submission: You need to submit both neural_networks.py and utils.py.</h4>

<h3 id="Q1.-Mini-batch-Stochastic-Gradient-Descent">Q1. Mini batch Stochastic Gradient Descent</h3>

First, you need to implement mini-batch stochastic gradient descent which is a gradient-based optimization to learn the parameters of the neural network.You need to realize two alternatives for SGD, one without momentum and one with momentum. We will pass a variable <span id="MathJax-Element-18-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>"><span id="MathJax-Span-625" class="math"><span id="MathJax-Span-626" class="mrow"><span id="MathJax-Span-627" class="mi">α</span></span></span><span class="MJX_Assistive_MathML" role="presentation">α</span></span> to indicate which option. When <span id="MathJax-Element-19-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>&amp;#x2264;</mo><mn>0</mn></math>"><span id="MathJax-Span-628" class="math"><span id="MathJax-Span-629" class="mrow"><span id="MathJax-Span-630" class="mi">α</span><span id="MathJax-Span-631" class="mo">≤</span><span id="MathJax-Span-632" class="mn">0</span></span></span><span class="MJX_Assistive_MathML" role="presentation">α≤0</span></span>, the parameters are updated just by gradient. When <span id="MathJax-Element-20-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>&amp;gt;</mo><mn>0</mn></math>"><span id="MathJax-Span-633" class="math"><span id="MathJax-Span-634" class="mrow"><span id="MathJax-Span-635" class="mi">α</span><span id="MathJax-Span-636" class="mo">&gt;</span><span id="MathJax-Span-637" class="mn">0</span></span></span><span class="MJX_Assistive_MathML" role="presentation">α&gt;0</span></span>, the parameters are updated with momentum and <span id="MathJax-Element-21-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>"><span id="MathJax-Span-638" class="math"><span id="MathJax-Span-639" class="mrow"><span id="MathJax-Span-640" class="mi">α</span></span></span><span class="MJX_Assistive_MathML" role="presentation">α</span></span> will also represents the discount factor as following:

You can use the formula above to update the weights.Here, <span id="MathJax-Element-23-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>"><span id="MathJax-Span-670" class="math"><span id="MathJax-Span-671" class="mrow"><span id="MathJax-Span-672" class="mi">α</span></span></span><span class="MJX_Assistive_MathML" role="presentation">α</span></span> is the discount factor such that <span id="MathJax-Element-24-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>"><span id="MathJax-Span-673" class="math"><span id="MathJax-Span-674" class="mrow"><span id="MathJax-Span-675" class="mi">α</span><span id="MathJax-Span-676" class="mo">∈</span><span id="MathJax-Span-677" class="mo">(</span><span id="MathJax-Span-678" class="mn">0</span><span id="MathJax-Span-679" class="mo">,</span><span id="MathJax-Span-680" class="mn">1</span><span id="MathJax-Span-681" class="mo">)</span></span></span><span class="MJX_Assistive_MathML" role="presentation">α∈(0,1)</span></span>. It is given by us and you do not need to adjust it.<span id="MathJax-Element-25-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B7;</mi></math>"><span id="MathJax-Span-682" class="math"><span id="MathJax-Span-683" class="mrow"><span id="MathJax-Span-684" class="mi">η</span></span></span><span class="MJX_Assistive_MathML" role="presentation">η</span></span> is the learning rate. It is also given by us.<span id="MathJax-Element-26-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C5;</mi></math>"><span id="MathJax-Span-685" class="math"><span id="MathJax-Span-686" class="mrow"><span id="MathJax-Span-687" class="mi">υ</span></span></span><span class="MJX_Assistive_MathML" role="presentation">υ</span></span> is the velocity update (A.K.A momentum update). <span id="MathJax-Element-27-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub></math>"><span id="MathJax-Span-688" class="math"><span id="MathJax-Span-689" class="mrow"><span id="MathJax-Span-690" class="msubsup"><span id="MathJax-Span-691" class="mi">δ</span><span id="MathJax-Span-692" class="mi">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">δt</span></span> is the gradient

<ul>

 <li><code>TODO 1</code> You need to complete <code>def miniBatchStochasticGradientDescent(model, momentum, _lambda, _alpha, _learning_rate)</code> in <code>neural_networks.py</code></li>

</ul>

Notice that for a complete mini-batch SGD, you will also need to find the best size of mini-batch and number of epochs. In this assignment, we omit this step. Both size of mini-batch and number of epoch has already been given. You do not need to adjust them.

<h3 id="Q2.-Linear-Layer-(15-points)">Q2. Linear Layer</h3>

Second, you need to implement the linear layer of MLP. In this part, you need to implement 3 python functions in <code>class linear_layer</code>.

In the function <code>def __init__(self, input_D, output_D)</code>, you need to initialize W with random values using np.random.normal such that the mean is 0 and standard deviation is 0.1. You also need to initialize gradients to zeroes in the same function.

You can use the above formula as a reference to implement the <code>def forward(self, X)</code> forward pass and <code>def backward(self, X, grad)</code> backward pass in class linear_layer. In backward pass, you only need to return the backward_output. You also need to compute gradients of W and b in backward pass.

<ul>

 <li><code>TODO 2</code> You need to complete <code>def __init__(self, input_D, output_D)</code> in <code>class linear_layer</code> of <code>neural_networks.py</code></li>

 <li><code>TODO 3</code> You need to complete <code>def forward(self, X)</code> in <code>class linear_layer</code> of <code>neural_networks.py</code></li>

 <li><code>TODO 4</code> You need to complete <code>def backward(self, X, grad)</code> in <code>class linear_layer</code> of <code>neural_networks.py</code></li>

</ul>

<h3 id="Q3.-Activation-function---tanh-(15-points)">Q3. Activation function – tanh</h3>

Now, you need to implement the activation function tanh. In this part, you need to implement 2 python functions in <code>class tanh</code>. In <code>def forward(self, X)</code>, you need to implement the forward pass and you need to compute the derivative and accordingly implement <code>def backward(self, X, grad)</code>, i.e. the backward pass.

You can use the above formula for tanh as a reference.

<ul>

 <li><code>TODO 5</code> You need to complete <code>def forward(self, X)</code> in <code>class tanh</code> of <code>neural_networks.py</code></li>

 <li><code>TODO 6</code> You need to complete <code>def backward(self, X, grad)</code> in <code>class tanh</code> of <code>neural_networks.py</code></li>

</ul>

<h3 id="Q4.-Activation-function---relu-(15-points)">Q4. Activation function – relu</h3>

You need to implement another activation function called relu. In this part, you need to implement 2 python functions in <code>class relu</code>. In <code>def forward(self, X)</code>, you need to implement the forward pass and you need to compute the derivative and accordingly implement <code>def backward(self, X, grad)</code>, i.e. the backward pass.

You can use the above formula for relu as a reference.

<ul>

 <li><code>TODO 7</code> You need to complete <code>def forward(self, X)</code> in <code>class relu</code> of <code>neural_networks.py</code></li>

 <li><code>TODO 8</code> You need to complete <code>def backward(self, X, grad)</code> in <code>class relu</code> of <code>neural_networks.py</code></li>

</ul>

<h3 id="Q5.-Dropout-(15-points)">Q5. Dropout (15 points)</h3>

To prevent overfitting, we usually add regularization. Dropout is another way of handling overfitting. In this part, you will initially read and understand <code>def forward(self, X, is_train)</code> i.e. the forward pass of <code>class dropout</code>. You will also derive partial derivatives accordingly to implement <code>def backward(self, X, grad)</code> i.e. the backward pass of <code>class dropout</code>.Now we take an intermediate variable <span id="MathJax-Element-31-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mi>J</mi></msup></math>"><span id="MathJax-Span-914" class="math"><span id="MathJax-Span-915" class="mrow"><span id="MathJax-Span-916" class="mi">q</span><span id="MathJax-Span-917" class="mo">∈</span><span id="MathJax-Span-918" class="msubsup"><span id="MathJax-Span-919" class="texatom"><span id="MathJax-Span-920" class="mrow"><span id="MathJax-Span-921" class="mi">R</span></span></span><span id="MathJax-Span-922" class="mi">J</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">q∈RJ</span></span> which is the output from one of the layers. Then we define the forward and the backward passes in dropout as follows.The forward pass obtains the output after dropout.

The backward pass computes the partial derivative of loss with respect to <span id="MathJax-Element-33-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>"><span id="MathJax-Span-1039" class="math"><span id="MathJax-Span-1040" class="mrow"><span id="MathJax-Span-1041" class="mi">q</span></span></span><span class="MJX_Assistive_MathML" role="presentation">q</span></span> from the one with respect to the forward pass result, which is <span id="MathJax-Element-34-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>s</mi></mrow></mfrac></math>"><span id="MathJax-Span-1042" class="math"><span id="MathJax-Span-1043" class="mrow"><span id="MathJax-Span-1044" class="mfrac"><span id="MathJax-Span-1045" class="mrow"><span id="MathJax-Span-1046" class="mi">∂</span><span id="MathJax-Span-1047" class="mi">l</span></span><span id="MathJax-Span-1048" class="mrow"><span id="MathJax-Span-1049" class="mi">∂</span><span id="MathJax-Span-1050" class="mi">s</span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">∂l∂s</span></span>.

Note that <span id="MathJax-Element-36-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>j</mi></msub><mo>,</mo><mi>j</mi><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><mi>J</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>"><span id="MathJax-Span-1175" class="math"><span id="MathJax-Span-1176" class="mrow"><span id="MathJax-Span-1177" class="msubsup"><span id="MathJax-Span-1178" class="mi">p</span><span id="MathJax-Span-1179" class="mi">j</span></span><span id="MathJax-Span-1180" class="mo">,</span><span id="MathJax-Span-1181" class="mi">j</span><span id="MathJax-Span-1182" class="mo">∈</span><span id="MathJax-Span-1183" class="mo">{</span><span id="MathJax-Span-1184" class="mn">1</span><span id="MathJax-Span-1185" class="mo">,</span><span id="MathJax-Span-1186" class="mo">⋯</span><span id="MathJax-Span-1187" class="mo">,</span><span id="MathJax-Span-1188" class="mi">J</span><span id="MathJax-Span-1189" class="mo">}</span></span></span><span class="MJX_Assistive_MathML" role="presentation">pj,j∈{1,⋯,J}</span></span> and <span id="MathJax-Element-37-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>"><span id="MathJax-Span-1190" class="math"><span id="MathJax-Span-1191" class="mrow"><span id="MathJax-Span-1192" class="mi">r</span></span></span><span class="MJX_Assistive_MathML" role="presentation">r</span></span> are not be learned so we do not need to compute the derivatives w.r.t. to them. You do not need to find the best <span id="MathJax-Element-38-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>"><span id="MathJax-Span-1193" class="math"><span id="MathJax-Span-1194" class="mrow"><span id="MathJax-Span-1195" class="mi">r</span></span></span><span class="MJX_Assistive_MathML" role="presentation">r</span></span> since we have picked it for you. Moreover, <span id="MathJax-Element-39-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>j</mi></msub><mo>,</mo><mi>j</mi><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><mi>J</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>"><span id="MathJax-Span-1196" class="math"><span id="MathJax-Span-1197" class="mrow"><span id="MathJax-Span-1198" class="msubsup"><span id="MathJax-Span-1199" class="mi">p</span><span id="MathJax-Span-1200" class="mi">j</span></span><span id="MathJax-Span-1201" class="mo">,</span><span id="MathJax-Span-1202" class="mi">j</span><span id="MathJax-Span-1203" class="mo">∈</span><span id="MathJax-Span-1204" class="mo">{</span><span id="MathJax-Span-1205" class="mn">1</span><span id="MathJax-Span-1206" class="mo">,</span><span id="MathJax-Span-1207" class="mo">⋯</span><span id="MathJax-Span-1208" class="mo">,</span><span id="MathJax-Span-1209" class="mi">J</span><span id="MathJax-Span-1210" class="mo">}</span></span></span><span class="MJX_Assistive_MathML" role="presentation">pj,j∈{1,⋯,J}</span></span> are re-sampled every forward pass, and are kept for the corresponding backward pass.

<ul>

 <li><code>TODO 9</code> You need to complete <code>def backward(self, X, grad)</code> in <code>class dropout</code> of <code>neural_networks.py</code></li>

</ul>

<h3 id="Q6.-Connecting-the-dots">Q6. Connecting the dots</h3>

In this part, you will combine the modules written from question Q1 to Q5 by implementing TODO snippets in the <code>def main(main_params, optimization_type="minibatch_sgd")</code> i.e. main function. After implementing forward and backward passes of MLP layers in Q1 to Q5,now in the main function you will call the forward methods and backward methods of every layer in the model in an appropriate order based on the architecture.

<ul>

 <li><code>TODO 10</code> You need to complete <code>main(main_params, optimization_type="minibatch_sgd")</code> in <code>neural_networks.py</code></li>

</ul>

<h3 id="Google-Colab">Google Colab</h3>

Google colab is a free online jupyter notebook made available by google for researchers/students wherein the jupyter notebook is backed by GPU.

Jupyter notebook is a python notebook with executable cells accompanied by textual texts for better documentation of the code. They are a good way to document the code.

GPUs are now standard way to compute weights and gradients during training of neural networks, they are faster than CPUs due to their inherent parallelization nature.

We highly suggest trying it for computation of your forward networks and tinkering around with the num_epochs, learning rate to see how the training loss varies. You can look at it here:

<a href="https://colab.research.google.com/">https://colab.research.google.com/</a>

<h4 id="Note">Note</h4>

Do NOT change the hyperparameters and submit on vocareum even if your changes give better training loss. Changing the hyperparemeters is just for your understanding of how gradient descent is working to optimize the code.

<span class="kksr-muted">Rate this product</span>

<span id="MathJax-Element-2-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>input features</mtext></mrow><mo>:</mo><mspace width=&quot;15pt&quot; /></mtd><mtd><mi>x</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mi>D</mi></msup></mtd></mtr><mtr><mtd><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>linear</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>:</mo><mspace width=&quot;15pt&quot; /></mtd><mtd><mi>u</mi><mo>=</mo><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mi>x</mi><mo>+</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mspace width=&quot;2em&quot; /><mo>,</mo><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>M</mi><mo>&amp;#x00D7;</mo><mi>D</mi></mrow></msup><mtext>&amp;#xA0;and&amp;#xA0;</mtext><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>M</mi></mrow></msup></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>tanh</mtext></mrow><mo>:</mo><mspace width=&quot;15pt&quot; /></mtd><mtd><mi>h</mi><mo>=</mo><mfrac><mrow><mpadded width=&quot;0&quot; height=&quot;8.6pt&quot; depth=&quot;3pt&quot;><mrow /></mpadded><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></mstyle></mrow><mrow><mpadded width=&quot;0&quot; height=&quot;8.6pt&quot; depth=&quot;3pt&quot;><mrow /></mpadded><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>2</mn><mi>u</mi></mrow></msup></mrow></mstyle></mrow></mfrac><mo>&amp;#x2212;</mo><mn>1</mn></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>relu</mtext></mrow><mo>:</mo><mspace width=&quot;15pt&quot; /></mtd><mtd><mi>h</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mi>u</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><msub><mi>u</mi><mn>1</mn></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></mtd></mtr><mtr><mtd><mo>&amp;#x22EE;</mo></mtd></mtr><mtr><mtd><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><msub><mi>u</mi><mi>M</mi></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>linear</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>:</mo><mspace width=&quot;15pt&quot; /></mtd><mtd><mi>a</mi><mo>=</mo><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mi>h</mi><mo>+</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mspace width=&quot;2em&quot; /><mo>,</mo><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi><mo>&amp;#x00D7;</mo><mi>M</mi></mrow></msup><mtext>&amp;#xA0;and&amp;#xA0;</mtext><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></msup></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>softmax</mtext></mrow><mo>:</mo><mspace width=&quot;15pt&quot; /></mtd><mtd><mi>z</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mfrac><mrow><mpadded width=&quot;0&quot; height=&quot;8.6pt&quot; depth=&quot;3pt&quot;><mrow /></mpadded><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>a</mi><mn>1</mn></msub></mrow></msup></mrow></mstyle></mrow><mrow><mpadded width=&quot;0&quot; height=&quot;8.6pt&quot; depth=&quot;3pt&quot;><mrow /></mpadded><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></msub></mrow></msup></mrow></mstyle></mrow></mfrac></mtd></mtr><mtr><mtd><mo>&amp;#x22EE;</mo></mtd></mtr><mtr><mtd><mfrac><mrow><mpadded width=&quot;0&quot; height=&quot;8.6pt&quot; depth=&quot;3pt&quot;><mrow /></mpadded><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>a</mi><mi>K</mi></msub></mrow></msup></mrow></mstyle></mrow><mrow><mpadded width=&quot;0&quot; height=&quot;8.6pt&quot; depth=&quot;3pt&quot;><mrow /></mpadded><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></msub></mrow></msup></mrow></mstyle></mrow></mfrac></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>predicted label</mtext></mrow><mo>:</mo><mspace width=&quot;15pt&quot; /></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>g</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>x</mi></mrow><mi>k</mi></msub><msub><mi>z</mi><mi>k</mi></msub><mo>.</mo></mtd></mtr></mtable></math>"><span id="MathJax-Span-24" class="math"><span id="MathJax-Span-25" class="mrow"><span id="MathJax-Span-26" class="mtable"><span id="MathJax-Span-27" class="mtd"><span id="MathJax-Span-28" class="mrow"><span id="MathJax-Span-29" class="texatom"><span id="MathJax-Span-30" class="mrow"><span id="MathJax-Span-31" class="mtext">input features</span></span></span><span id="MathJax-Span-32" class="mo">:</span><span id="MathJax-Span-33" class="mspace"></span></span></span><span id="MathJax-Span-43" class="mtd"><span id="MathJax-Span-44" class="mrow"><span id="MathJax-Span-45" class="msubsup"><span id="MathJax-Span-46" class="texatom"><span id="MathJax-Span-47" class="mrow"><span id="MathJax-Span-48" class="mtext">linear</span></span></span><span id="MathJax-Span-49" class="texatom"><span id="MathJax-Span-50" class="mrow"><span id="MathJax-Span-51" class="mo">(</span><span id="MathJax-Span-52" class="mn">1</span><span id="MathJax-Span-53" class="mo">)</span></span></span></span><span id="MathJax-Span-54" class="mo">:</span><span id="MathJax-Span-55" class="mspace"></span></span></span><span id="MathJax-Span-111" class="mtd"><span id="MathJax-Span-112" class="mrow"><span id="MathJax-Span-113" class="texatom"><span id="MathJax-Span-114" class="mrow"><span id="MathJax-Span-115" class="mtext">tanh</span></span></span><span id="MathJax-Span-116" class="mo">:</span><span id="MathJax-Span-117" class="mspace"></span></span></span><span id="MathJax-Span-151" class="mtd"><span id="MathJax-Span-152" class="mrow"><span id="MathJax-Span-153" class="texatom"><span id="MathJax-Span-154" class="mrow"><span id="MathJax-Span-155" class="mtext">relu</span></span></span><span id="MathJax-Span-156" class="mo">:</span><span id="MathJax-Span-157" class="mspace"></span></span></span><span id="MathJax-Span-198" class="mtd"><span id="MathJax-Span-199" class="mrow"><span id="MathJax-Span-200" class="msubsup"><span id="MathJax-Span-201" class="texatom"><span id="MathJax-Span-202" class="mrow"><span id="MathJax-Span-203" class="mtext">linear</span></span></span><span id="MathJax-Span-204" class="texatom"><span id="MathJax-Span-205" class="mrow"><span id="MathJax-Span-206" class="mo">(</span><span id="MathJax-Span-207" class="mn">2</span><span id="MathJax-Span-208" class="mo">)</span></span></span></span><span id="MathJax-Span-209" class="mo">:</span><span id="MathJax-Span-210" class="mspace"></span></span></span><span id="MathJax-Span-266" class="mtd"><span id="MathJax-Span-267" class="mrow"><span id="MathJax-Span-268" class="texatom"><span id="MathJax-Span-269" class="mrow"><span id="MathJax-Span-270" class="mtext">softmax</span></span></span><span id="MathJax-Span-271" class="mo">:</span><span id="MathJax-Span-272" class="mspace"></span></span></span><span id="MathJax-Span-364" class="mtd"><span id="MathJax-Span-365" class="mrow"><span id="MathJax-Span-366" class="texatom"><span id="MathJax-Span-367" class="mrow"><span id="MathJax-Span-368" class="mtext">predicted label</span></span></span><span id="MathJax-Span-369" class="mo">:</span><span id="MathJax-Span-370" class="mspace"></span></span></span><span id="MathJax-Span-34" class="mtd"><span id="MathJax-Span-35" class="mrow"><span id="MathJax-Span-36" class="mi">x</span><span id="MathJax-Span-37" class="mo">∈</span><span id="MathJax-Span-38" class="msubsup"><span id="MathJax-Span-39" class="texatom"><span id="MathJax-Span-40" class="mrow"><span id="MathJax-Span-41" class="mi">R</span></span></span><span id="MathJax-Span-42" class="mi">D</span></span></span></span><span id="MathJax-Span-56" class="mtd"><span id="MathJax-Span-57" class="mrow"><span id="MathJax-Span-58" class="mi">u</span><span id="MathJax-Span-59" class="mo">=</span><span id="MathJax-Span-60" class="msubsup"><span id="MathJax-Span-61" class="mi">W</span><span id="MathJax-Span-62" class="texatom"><span id="MathJax-Span-63" class="mrow"><span id="MathJax-Span-64" class="mo">(</span><span id="MathJax-Span-65" class="mn">1</span><span id="MathJax-Span-66" class="mo">)</span></span></span></span><span id="MathJax-Span-67" class="mi">x</span><span id="MathJax-Span-68" class="mo">+</span><span id="MathJax-Span-69" class="msubsup"><span id="MathJax-Span-70" class="mi">b</span><span id="MathJax-Span-71" class="texatom"><span id="MathJax-Span-72" class="mrow"><span id="MathJax-Span-73" class="mo">(</span><span id="MathJax-Span-74" class="mn">1</span><span id="MathJax-Span-75" class="mo">)</span></span></span></span><span id="MathJax-Span-76" class="mspace"></span><span id="MathJax-Span-77" class="mo">,</span><span id="MathJax-Span-78" class="msubsup"><span id="MathJax-Span-79" class="mi">W</span><span id="MathJax-Span-80" class="texatom"><span id="MathJax-Span-81" class="mrow"><span id="MathJax-Span-82" class="mo">(</span><span id="MathJax-Span-83" class="mn">1</span><span id="MathJax-Span-84" class="mo">)</span></span></span></span><span id="MathJax-Span-85" class="mo">∈</span><span id="MathJax-Span-86" class="msubsup"><span id="MathJax-Span-87" class="texatom"><span id="MathJax-Span-88" class="mrow"><span id="MathJax-Span-89" class="mi">R</span></span></span><span id="MathJax-Span-90" class="texatom"><span id="MathJax-Span-91" class="mrow"><span id="MathJax-Span-92" class="mi">M</span><span id="MathJax-Span-93" class="mo">×</span><span id="MathJax-Span-94" class="mi">D</span></span></span></span><span id="MathJax-Span-95" class="mtext"> and </span><span id="MathJax-Span-96" class="msubsup"><span id="MathJax-Span-97" class="mi">b</span><span id="MathJax-Span-98" class="texatom"><span id="MathJax-Span-99" class="mrow"><span id="MathJax-Span-100" class="mo">(</span><span id="MathJax-Span-101" class="mn">1</span><span id="MathJax-Span-102" class="mo">)</span></span></span></span><span id="MathJax-Span-103" class="mo">∈</span><span id="MathJax-Span-104" class="msubsup"><span id="MathJax-Span-105" class="texatom"><span id="MathJax-Span-106" class="mrow"><span id="MathJax-Span-107" class="mi">R</span></span></span><span id="MathJax-Span-108" class="texatom"><span id="MathJax-Span-109" class="mrow"><span id="MathJax-Span-110" class="mi">M</span></span></span></span></span></span><span id="MathJax-Span-118" class="mtd"><span id="MathJax-Span-119" class="mrow"><span id="MathJax-Span-120" class="mi">h</span><span id="MathJax-Span-121" class="mo">=</span><span id="MathJax-Span-122" class="mfrac"><span id="MathJax-Span-123" class="mrow"><span id="MathJax-Span-124" class="mpadded"><span id="MathJax-Span-125" class="mrow"><span id="MathJax-Span-126" class="mrow"></span></span></span><span id="MathJax-Span-127" class="mstyle"><span id="MathJax-Span-128" class="mrow"><span id="MathJax-Span-129" class="texatom"><span id="MathJax-Span-130" class="mrow"><span id="MathJax-Span-131" class="mn">2</span></span></span></span></span></span><span id="MathJax-Span-132" class="mrow"><span id="MathJax-Span-133" class="mpadded"><span id="MathJax-Span-134" class="mrow"><span id="MathJax-Span-135" class="mrow"></span></span></span><span id="MathJax-Span-136" class="mstyle"><span id="MathJax-Span-137" class="mrow"><span id="MathJax-Span-138" class="texatom"><span id="MathJax-Span-139" class="mrow"><span id="MathJax-Span-140" class="mn">1</span><span id="MathJax-Span-141" class="mo">+</span><span id="MathJax-Span-142" class="msubsup"><span id="MathJax-Span-143" class="mi">e</span><span id="MathJax-Span-144" class="texatom"><span id="MathJax-Span-145" class="mrow"><span id="MathJax-Span-146" class="mo">−</span><span id="MathJax-Span-147" class="mn">2</span><span id="MathJax-Span-148" class="mi">u</span></span></span></span></span></span></span></span></span></span><span id="MathJax-Span-149" class="mo">−</span><span id="MathJax-Span-150" class="mn">1</span></span></span><span id="MathJax-Span-158" class="mtd"><span id="MathJax-Span-159" class="mrow"><span id="MathJax-Span-160" class="mi">h</span><span id="MathJax-Span-161" class="mo">=</span><span id="MathJax-Span-162" class="mi">m</span><span id="MathJax-Span-163" class="mi">a</span><span id="MathJax-Span-164" class="mi">x</span><span id="MathJax-Span-165" class="mo">{</span><span id="MathJax-Span-166" class="mn">0</span><span id="MathJax-Span-167" class="mo">,</span><span id="MathJax-Span-168" class="mi">u</span><span id="MathJax-Span-169" class="mo">}</span><span id="MathJax-Span-170" class="mo">=</span><span id="MathJax-Span-171" class="mrow"><span id="MathJax-Span-172" class="mo">⎡⎣⎢⎢</span><span id="MathJax-Span-173" class="mtable"><span id="MathJax-Span-174" class="mtd"><span id="MathJax-Span-175" class="mrow"><span id="MathJax-Span-176" class="mo">max</span><span id="MathJax-Span-177" class="mo">{</span><span id="MathJax-Span-178" class="mn">0</span><span id="MathJax-Span-179" class="mo">,</span><span id="MathJax-Span-180" class="msubsup"><span id="MathJax-Span-181" class="mi">u</span><span id="MathJax-Span-182" class="mn">1</span></span><span id="MathJax-Span-183" class="mo">}</span></span></span><span id="MathJax-Span-184" class="mtd"><span id="MathJax-Span-185" class="mrow"><span id="MathJax-Span-186" class="mo">⋮</span></span></span><span id="MathJax-Span-187" class="mtd"><span id="MathJax-Span-188" class="mrow"><span id="MathJax-Span-189" class="mo">max</span><span id="MathJax-Span-190" class="mo">{</span><span id="MathJax-Span-191" class="mn">0</span><span id="MathJax-Span-192" class="mo">,</span><span id="MathJax-Span-193" class="msubsup"><span id="MathJax-Span-194" class="mi">u</span><span id="MathJax-Span-195" class="mi">M</span></span><span id="MathJax-Span-196" class="mo">}</span></span></span></span><span id="MathJax-Span-197" class="mo">⎤⎦⎥⎥</span></span></span></span><span id="MathJax-Span-211" class="mtd"><span id="MathJax-Span-212" class="mrow"><span id="MathJax-Span-213" class="mi">a</span><span id="MathJax-Span-214" class="mo">=</span><span id="MathJax-Span-215" class="msubsup"><span id="MathJax-Span-216" class="mi">W</span><span id="MathJax-Span-217" class="texatom"><span id="MathJax-Span-218" class="mrow"><span id="MathJax-Span-219" class="mo">(</span><span id="MathJax-Span-220" class="mn">2</span><span id="MathJax-Span-221" class="mo">)</span></span></span></span><span id="MathJax-Span-222" class="mi">h</span><span id="MathJax-Span-223" class="mo">+</span><span id="MathJax-Span-224" class="msubsup"><span id="MathJax-Span-225" class="mi">b</span><span id="MathJax-Span-226" class="texatom"><span id="MathJax-Span-227" class="mrow"><span id="MathJax-Span-228" class="mo">(</span><span id="MathJax-Span-229" class="mn">2</span><span id="MathJax-Span-230" class="mo">)</span></span></span></span><span id="MathJax-Span-231" class="mspace"></span><span id="MathJax-Span-232" class="mo">,</span><span id="MathJax-Span-233" class="msubsup"><span id="MathJax-Span-234" class="mi">W</span><span id="MathJax-Span-235" class="texatom"><span id="MathJax-Span-236" class="mrow"><span id="MathJax-Span-237" class="mo">(</span><span id="MathJax-Span-238" class="mn">2</span><span id="MathJax-Span-239" class="mo">)</span></span></span></span><span id="MathJax-Span-240" class="mo">∈</span><span id="MathJax-Span-241" class="msubsup"><span id="MathJax-Span-242" class="texatom"><span id="MathJax-Span-243" class="mrow"><span id="MathJax-Span-244" class="mi">R</span></span></span><span id="MathJax-Span-245" class="texatom"><span id="MathJax-Span-246" class="mrow"><span id="MathJax-Span-247" class="mi">K</span><span id="MathJax-Span-248" class="mo">×</span><span id="MathJax-Span-249" class="mi">M</span></span></span></span><span id="MathJax-Span-250" class="mtext"> and </span><span id="MathJax-Span-251" class="msubsup"><span id="MathJax-Span-252" class="mi">b</span><span id="MathJax-Span-253" class="texatom"><span id="MathJax-Span-254" class="mrow"><span id="MathJax-Span-255" class="mo">(</span><span id="MathJax-Span-256" class="mn">2</span><span id="MathJax-Span-257" class="mo">)</span></span></span></span><span id="MathJax-Span-258" class="mo">∈</span><span id="MathJax-Span-259" class="msubsup"><span id="MathJax-Span-260" class="texatom"><span id="MathJax-Span-261" class="mrow"><span id="MathJax-Span-262" class="mi">R</span></span></span><span id="MathJax-Span-263" class="texatom"><span id="MathJax-Span-264" class="mrow"><span id="MathJax-Span-265" class="mi">K</span></span></span></span></span></span><span id="MathJax-Span-273" class="mtd"><span id="MathJax-Span-274" class="mrow"><span id="MathJax-Span-275" class="mi">z</span><span id="MathJax-Span-276" class="mo">=</span><span id="MathJax-Span-277" class="mrow"><span id="MathJax-Span-278" class="mo">⎡⎣⎢⎢⎢⎢⎢⎢⎢⎢</span><span id="MathJax-Span-279" class="mtable"><span id="MathJax-Span-280" class="mtd"><span id="MathJax-Span-281" class="mrow"><span id="MathJax-Span-282" class="mfrac"><span id="MathJax-Span-283" class="mrow"><span id="MathJax-Span-284" class="mpadded"><span id="MathJax-Span-285" class="mrow"><span id="MathJax-Span-286" class="mrow"></span></span></span><span id="MathJax-Span-287" class="mstyle"><span id="MathJax-Span-288" class="mrow"><span id="MathJax-Span-289" class="texatom"><span id="MathJax-Span-290" class="mrow"><span id="MathJax-Span-291" class="msubsup"><span id="MathJax-Span-292" class="mi">e</span><span id="MathJax-Span-293" class="texatom"><span id="MathJax-Span-294" class="mrow"><span id="MathJax-Span-295" class="msubsup"><span id="MathJax-Span-296" class="mi">a</span><span id="MathJax-Span-297" class="mn">1</span></span></span></span></span></span></span></span></span></span><span id="MathJax-Span-298" class="mrow"><span id="MathJax-Span-299" class="mpadded"><span id="MathJax-Span-300" class="mrow"><span id="MathJax-Span-301" class="mrow"></span></span></span><span id="MathJax-Span-302" class="mstyle"><span id="MathJax-Span-303" class="mrow"><span id="MathJax-Span-304" class="texatom"><span id="MathJax-Span-305" class="mrow"><span id="MathJax-Span-306" class="munderover"><span id="MathJax-Span-307" class="mo">∑</span><span id="MathJax-Span-308" class="texatom"><span id="MathJax-Span-309" class="mrow"><span id="MathJax-Span-310" class="mi">k</span></span></span></span><span id="MathJax-Span-311" class="msubsup"><span id="MathJax-Span-312" class="mi">e</span><span id="MathJax-Span-313" class="texatom"><span id="MathJax-Span-314" class="mrow"><span id="MathJax-Span-315" class="msubsup"><span id="MathJax-Span-316" class="mi">a</span><span id="MathJax-Span-317" class="texatom"><span id="MathJax-Span-318" class="mrow"><span id="MathJax-Span-319" class="mi">k</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span id="MathJax-Span-320" class="mtd"><span id="MathJax-Span-321" class="mrow"><span id="MathJax-Span-322" class="mo">⋮</span></span></span><span id="MathJax-Span-323" class="mtd"><span id="MathJax-Span-324" class="mrow"><span id="MathJax-Span-325" class="mfrac"><span id="MathJax-Span-326" class="mrow"><span id="MathJax-Span-327" class="mpadded"><span id="MathJax-Span-328" class="mrow"><span id="MathJax-Span-329" class="mrow"></span></span></span><span id="MathJax-Span-330" class="mstyle"><span id="MathJax-Span-331" class="mrow"><span id="MathJax-Span-332" class="texatom"><span id="MathJax-Span-333" class="mrow"><span id="MathJax-Span-334" class="msubsup"><span id="MathJax-Span-335" class="mi">e</span><span id="MathJax-Span-336" class="texatom"><span id="MathJax-Span-337" class="mrow"><span id="MathJax-Span-338" class="msubsup"><span id="MathJax-Span-339" class="mi">a</span><span id="MathJax-Span-340" class="mi">K</span></span></span></span></span></span></span></span></span></span><span id="MathJax-Span-341" class="mrow"><span id="MathJax-Span-342" class="mpadded"><span id="MathJax-Span-343" class="mrow"><span id="MathJax-Span-344" class="mrow"></span></span></span><span id="MathJax-Span-345" class="mstyle"><span id="MathJax-Span-346" class="mrow"><span id="MathJax-Span-347" class="texatom"><span id="MathJax-Span-348" class="mrow"><span id="MathJax-Span-349" class="munderover"><span id="MathJax-Span-350" class="mo">∑</span><span id="MathJax-Span-351" class="texatom"><span id="MathJax-Span-352" class="mrow"><span id="MathJax-Span-353" class="mi">k</span></span></span></span><span id="MathJax-Span-354" class="msubsup"><span id="MathJax-Span-355" class="mi">e</span><span id="MathJax-Span-356" class="texatom"><span id="MathJax-Span-357" class="mrow"><span id="MathJax-Span-358" class="msubsup"><span id="MathJax-Span-359" class="mi">a</span><span id="MathJax-Span-360" class="texatom"><span id="MathJax-Span-361" class="mrow"><span id="MathJax-Span-362" class="mi">k</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span id="MathJax-Span-363" class="mo">⎤⎦⎥⎥⎥⎥⎥⎥⎥⎥</span></span></span></span><span id="MathJax-Span-371" class="mtd"><span id="MathJax-Span-372" class="mrow"><span id="MathJax-Span-373" class="texatom"><span id="MathJax-Span-374" class="mrow"><span id="MathJax-Span-375" class="munderover"><span id="MathJax-Span-376" class="mi">y</span><span id="MathJax-Span-377" class="mo">^</span></span></span></span><span id="MathJax-Span-378" class="mo">=</span><span id="MathJax-Span-379" class="msubsup"><span id="MathJax-Span-380" class="texatom"><span id="MathJax-Span-381" class="mrow"><span id="MathJax-Span-382" class="mi">a</span><span id="MathJax-Span-383" class="mi">r</span><span id="MathJax-Span-384" class="mi">g</span><span id="MathJax-Span-385" class="mi">m</span><span id="MathJax-Span-386" class="mi">a</span><span id="MathJax-Span-387" class="mi">x</span></span></span><span id="MathJax-Span-388" class="mi">k</span></span><span id="MathJax-Span-389" class="msubsup"><span id="MathJax-Span-390" class="mi">z</span><span id="MathJax-Span-391" class="mi">k</span></span><span id="MathJax-Span-392" class="mo">.</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">input features:x∈RDlinear(1):u=W(1)x+b(1),W(1)∈RM×D and b(1)∈RMtanh:h=21+e−2u−1relu:h=max{0,u}=[max{0,u1}⋮max{0,uM}]linear(2):a=W(2)h+b(2),W(2)∈RK×M and b(2)∈RKsoftmax:z=[ea1∑keak⋮eaK∑keak]predicted label:y^=argmaxkzk.</span></span>

<span id="MathJax-Element-10-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>l</mi><mo>=</mo><mo>&amp;#x2212;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>z</mi><mi>y</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>log</mi><mo>&amp;#x2061;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2260;</mo><mi>y</mi></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>a</mi><mi>k</mi></msub><mo>&amp;#x2212;</mo><msub><mi>a</mi><mi>y</mi></msub></mrow></msup></mrow><mo>)</mo></mrow></mtd></mtr></mtable></math>"><span id="MathJax-Span-442" class="math"><span id="MathJax-Span-443" class="mrow"><span id="MathJax-Span-444" class="mtable"><span id="MathJax-Span-445" class="mtd"><span id="MathJax-Span-446" class="mrow"><span id="MathJax-Span-447" class="mi">l</span><span id="MathJax-Span-448" class="mo">=</span><span id="MathJax-Span-449" class="mo">−</span><span id="MathJax-Span-450" class="mi">log</span><span id="MathJax-Span-451" class="mo"></span><span id="MathJax-Span-452" class="mo">(</span><span id="MathJax-Span-453" class="msubsup"><span id="MathJax-Span-454" class="mi">z</span><span id="MathJax-Span-455" class="mi">y</span></span><span id="MathJax-Span-456" class="mo">)</span><span id="MathJax-Span-457" class="mo">=</span><span id="MathJax-Span-458" class="mi">log</span><span id="MathJax-Span-459" class="mo"></span><span id="MathJax-Span-460" class="mrow"><span id="MathJax-Span-461" class="mo">(</span><span id="MathJax-Span-462" class="mrow"><span id="MathJax-Span-463" class="mn">1</span><span id="MathJax-Span-464" class="mo">+</span><span id="MathJax-Span-465" class="munderover"><span id="MathJax-Span-466" class="mo">∑</span><span id="MathJax-Span-467" class="texatom"><span id="MathJax-Span-468" class="mrow"><span id="MathJax-Span-469" class="mi">k</span><span id="MathJax-Span-470" class="mo">≠</span><span id="MathJax-Span-471" class="mi">y</span></span></span></span><span id="MathJax-Span-472" class="msubsup"><span id="MathJax-Span-473" class="mi">e</span><span id="MathJax-Span-474" class="texatom"><span id="MathJax-Span-475" class="mrow"><span id="MathJax-Span-476" class="msubsup"><span id="MathJax-Span-477" class="mi">a</span><span id="MathJax-Span-478" class="mi">k</span></span><span id="MathJax-Span-479" class="mo">−</span><span id="MathJax-Span-480" class="msubsup"><span id="MathJax-Span-481" class="mi">a</span><span id="MathJax-Span-482" class="mi">y</span></span></span></span></span></span><span id="MathJax-Span-483" class="mo">)</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">l=−log⁡(zy)=log⁡(1+∑k≠yeak−ay)</span></span>

<span id="MathJax-Element-16-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>y</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mi>K</mi></msup><mtext>&amp;#xA0;and&amp;#xA0;</mtext><msub><mi>y</mi><mi>k</mi></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;><mtr><mtd><mn>1</mn><mo>,</mo><mtext>&amp;#xA0;if&amp;#xA0;</mtext><mi>y</mi><mo>=</mo><mi>k</mi><mo>,</mo></mtd></mtr><mtr><mtd><mn>0</mn><mo>,</mo><mtext>&amp;#xA0;otherwise</mtext><mo>.</mo></mtd></mtr></mtable><mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;></mo></mrow></mtd></mtr></mtable></math>"><span id="MathJax-Span-527" class="math"><span id="MathJax-Span-528" class="mrow"><span id="MathJax-Span-529" class="mtable"><span id="MathJax-Span-530" class="mtd"><span id="MathJax-Span-531" class="mrow"><span id="MathJax-Span-532" class="mi">y</span><span id="MathJax-Span-533" class="mo">∈</span><span id="MathJax-Span-534" class="msubsup"><span id="MathJax-Span-535" class="texatom"><span id="MathJax-Span-536" class="mrow"><span id="MathJax-Span-537" class="mi">R</span></span></span><span id="MathJax-Span-538" class="mi">K</span></span><span id="MathJax-Span-539" class="mtext"> and </span><span id="MathJax-Span-540" class="msubsup"><span id="MathJax-Span-541" class="mi">y</span><span id="MathJax-Span-542" class="mi">k</span></span><span id="MathJax-Span-543" class="mo">=</span><span id="MathJax-Span-544" class="mrow"><span id="MathJax-Span-545" class="mo">{</span><span id="MathJax-Span-546" class="mtable"><span id="MathJax-Span-547" class="mtd"><span id="MathJax-Span-548" class="mrow"><span id="MathJax-Span-549" class="mn">1</span><span id="MathJax-Span-550" class="mo">,</span><span id="MathJax-Span-551" class="mtext"> if </span><span id="MathJax-Span-552" class="mi">y</span><span id="MathJax-Span-553" class="mo">=</span><span id="MathJax-Span-554" class="mi">k</span><span id="MathJax-Span-555" class="mo">,</span></span></span><span id="MathJax-Span-556" class="mtd"><span id="MathJax-Span-557" class="mrow"><span id="MathJax-Span-558" class="mn">0</span><span id="MathJax-Span-559" class="mo">,</span><span id="MathJax-Span-560" class="mtext"> otherwise</span><span id="MathJax-Span-561" class="mo">.</span></span></span></span><span id="MathJax-Span-562" class="mo"></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">y∈RK and yk={1, if y=k,0, otherwise.</span></span>

<span id="MathJax-Element-17-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>l</mi><mo>=</mo><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></munder><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></msub><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>z</mi><mi>k</mi></msub></mrow><mo>=</mo><mo>&amp;#x2212;</mo><msup><mi>y</mi><mi>T</mi></msup><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>z</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>&amp;#x22EE;</mo></mtd></mtr><mtr><mtd><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>z</mi><mi>K</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mo>&amp;#x2212;</mo><msup><mi>y</mi><mi>T</mi></msup><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>z</mi></mrow><mo>.</mo></mtd></mtr></mtable></math>"><span id="MathJax-Span-563" class="math"><span id="MathJax-Span-564" class="mrow"><span id="MathJax-Span-565" class="mtable"><span id="MathJax-Span-566" class="mtd"><span id="MathJax-Span-567" class="mrow"><span id="MathJax-Span-568" class="mi">l</span><span id="MathJax-Span-569" class="mo">=</span><span id="MathJax-Span-570" class="mo">−</span><span id="MathJax-Span-571" class="munderover"><span id="MathJax-Span-572" class="mo">∑</span><span id="MathJax-Span-573" class="texatom"><span id="MathJax-Span-574" class="mrow"><span id="MathJax-Span-575" class="mi">k</span></span></span></span><span id="MathJax-Span-576" class="msubsup"><span id="MathJax-Span-577" class="mi">y</span><span id="MathJax-Span-578" class="texatom"><span id="MathJax-Span-579" class="mrow"><span id="MathJax-Span-580" class="mi">k</span></span></span></span><span id="MathJax-Span-581" class="mi">log</span><span id="MathJax-Span-582" class="mo"></span><span id="MathJax-Span-583" class="texatom"><span id="MathJax-Span-584" class="mrow"><span id="MathJax-Span-585" class="msubsup"><span id="MathJax-Span-586" class="mi">z</span><span id="MathJax-Span-587" class="mi">k</span></span></span></span><span id="MathJax-Span-588" class="mo">=</span><span id="MathJax-Span-589" class="mo">−</span><span id="MathJax-Span-590" class="msubsup"><span id="MathJax-Span-591" class="mi">y</span><span id="MathJax-Span-592" class="mi">T</span></span><span id="MathJax-Span-593" class="mrow"><span id="MathJax-Span-594" class="mo">⎡⎣⎢⎢</span><span id="MathJax-Span-595" class="mtable"><span id="MathJax-Span-596" class="mtd"><span id="MathJax-Span-597" class="mrow"><span id="MathJax-Span-598" class="mi">log</span><span id="MathJax-Span-599" class="mo"></span><span id="MathJax-Span-600" class="msubsup"><span id="MathJax-Span-601" class="mi">z</span><span id="MathJax-Span-602" class="mn">1</span></span></span></span><span id="MathJax-Span-603" class="mtd"><span id="MathJax-Span-604" class="mrow"><span id="MathJax-Span-605" class="mo">⋮</span></span></span><span id="MathJax-Span-606" class="mtd"><span id="MathJax-Span-607" class="mrow"><span id="MathJax-Span-608" class="mi">log</span><span id="MathJax-Span-609" class="mo"></span><span id="MathJax-Span-610" class="msubsup"><span id="MathJax-Span-611" class="mi">z</span><span id="MathJax-Span-612" class="mi">K</span></span></span></span></span><span id="MathJax-Span-613" class="mo">⎤⎦⎥⎥</span></span><span id="MathJax-Span-614" class="mo">=</span><span id="MathJax-Span-615" class="mo">−</span><span id="MathJax-Span-616" class="msubsup"><span id="MathJax-Span-617" class="mi">y</span><span id="MathJax-Span-618" class="mi">T</span></span><span id="MathJax-Span-619" class="mi">log</span><span id="MathJax-Span-620" class="mo"></span><span id="MathJax-Span-621" class="texatom"><span id="MathJax-Span-622" class="mrow"><span id="MathJax-Span-623" class="mi">z</span></span></span><span id="MathJax-Span-624" class="mo">.</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">l=−∑kyklog⁡zk=−yT[log⁡z1⋮log⁡zK]=−yTlog⁡z.</span></span>

<span id="MathJax-Element-22-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>&amp;#x03C5;</mi><mo>=</mo><mi>&amp;#x03B1;</mi><mi>&amp;#x03C5;</mi><mo>&amp;#x2212;</mo><mi>&amp;#x03B7;</mi><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd><msub><mi>w</mi><mi>t</mi></msub><mo>=</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>&amp;#x03C5;</mi></mtd></mtr></mtable></math>"><span id="MathJax-Span-641" class="math"><span id="MathJax-Span-642" class="mrow"><span id="MathJax-Span-643" class="mtable"><span id="MathJax-Span-644" class="mtd"><span id="MathJax-Span-645" class="mrow"><span id="MathJax-Span-646" class="mi">υ</span><span id="MathJax-Span-647" class="mo">=</span><span id="MathJax-Span-648" class="mi">α</span><span id="MathJax-Span-649" class="mi">υ</span><span id="MathJax-Span-650" class="mo">−</span><span id="MathJax-Span-651" class="mi">η</span><span id="MathJax-Span-652" class="msubsup"><span id="MathJax-Span-653" class="mi">δ</span><span id="MathJax-Span-654" class="mi">t</span></span></span></span><span id="MathJax-Span-655" class="mtd"><span id="MathJax-Span-656" class="mrow"><span id="MathJax-Span-657" class="msubsup"><span id="MathJax-Span-658" class="mi">w</span><span id="MathJax-Span-659" class="mi">t</span></span><span id="MathJax-Span-660" class="mo">=</span><span id="MathJax-Span-661" class="msubsup"><span id="MathJax-Span-662" class="mi">w</span><span id="MathJax-Span-663" class="texatom"><span id="MathJax-Span-664" class="mrow"><span id="MathJax-Span-665" class="mi">t</span><span id="MathJax-Span-666" class="mo">−</span><span id="MathJax-Span-667" class="mn">1</span></span></span></span><span id="MathJax-Span-668" class="mo">+</span><span id="MathJax-Span-669" class="mi">υ</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">υ=αυ−ηδtwt=wt−1+υ</span></span>

<span id="MathJax-Element-28-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mtext>forward pass:</mtext><mspace width=&quot;2em&quot; /></mtd><mtd><mi>u</mi><mo>=</mo><msup><mtext>linear</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mtext>.forward</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mi>x</mi><mo>+</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>,</mo></mtd></mtr><mtr><mtd /><mtd><mtext>where&amp;#xA0;</mtext><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mtext>&amp;#xA0;and&amp;#xA0;</mtext><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mtext>&amp;#xA0;are its parameters.</mtext></mtd></mtr><mtr><mtd /></mtr><mtr><mtd><mtext>backward pass:</mtext><mspace width=&quot;2em&quot; /></mtd><mtd><mi></mi><mo stretchy=&quot;false&quot;>[</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>x</mi></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msup><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></mrow></mfrac><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><msup><mtext>linear</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mtext>.backward</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>u</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></mtd></mtr></mtable></math>"><span id="MathJax-Span-693" class="math"><span id="MathJax-Span-694" class="mrow"><span id="MathJax-Span-695" class="mtable"><span id="MathJax-Span-696" class="mtd"><span id="MathJax-Span-697" class="mrow"><span id="MathJax-Span-698" class="mtext">forward pass:</span><span id="MathJax-Span-699" class="mspace"></span></span></span><span id="MathJax-Span-733" class="mtd"><span id="MathJax-Span-734" class="mrow"></span></span><span id="MathJax-Span-754" class="mtd"><span id="MathJax-Span-755" class="mrow"></span></span><span id="MathJax-Span-756" class="mtd"><span id="MathJax-Span-757" class="mrow"><span id="MathJax-Span-758" class="mtext">backward pass:</span><span id="MathJax-Span-759" class="mspace"></span></span></span><span id="MathJax-Span-700" class="mtd"><span id="MathJax-Span-701" class="mrow"><span id="MathJax-Span-702" class="mi">u</span><span id="MathJax-Span-703" class="mo">=</span><span id="MathJax-Span-704" class="msubsup"><span id="MathJax-Span-705" class="mtext">linear</span><span id="MathJax-Span-706" class="texatom"><span id="MathJax-Span-707" class="mrow"><span id="MathJax-Span-708" class="mo">(</span><span id="MathJax-Span-709" class="mn">1</span><span id="MathJax-Span-710" class="mo">)</span></span></span></span><span id="MathJax-Span-711" class="mtext">.forward</span><span id="MathJax-Span-712" class="mo">(</span><span id="MathJax-Span-713" class="mi">x</span><span id="MathJax-Span-714" class="mo">)</span><span id="MathJax-Span-715" class="mo">=</span><span id="MathJax-Span-716" class="msubsup"><span id="MathJax-Span-717" class="mi">W</span><span id="MathJax-Span-718" class="texatom"><span id="MathJax-Span-719" class="mrow"><span id="MathJax-Span-720" class="mo">(</span><span id="MathJax-Span-721" class="mn">1</span><span id="MathJax-Span-722" class="mo">)</span></span></span></span><span id="MathJax-Span-723" class="mi">x</span><span id="MathJax-Span-724" class="mo">+</span><span id="MathJax-Span-725" class="msubsup"><span id="MathJax-Span-726" class="mi">b</span><span id="MathJax-Span-727" class="texatom"><span id="MathJax-Span-728" class="mrow"><span id="MathJax-Span-729" class="mo">(</span><span id="MathJax-Span-730" class="mn">1</span><span id="MathJax-Span-731" class="mo">)</span></span></span></span><span id="MathJax-Span-732" class="mo">,</span></span></span><span id="MathJax-Span-735" class="mtd"><span id="MathJax-Span-736" class="mrow"><span id="MathJax-Span-737" class="mtext">where </span><span id="MathJax-Span-738" class="msubsup"><span id="MathJax-Span-739" class="mi">W</span><span id="MathJax-Span-740" class="texatom"><span id="MathJax-Span-741" class="mrow"><span id="MathJax-Span-742" class="mo">(</span><span id="MathJax-Span-743" class="mn">1</span><span id="MathJax-Span-744" class="mo">)</span></span></span></span><span id="MathJax-Span-745" class="mtext"> and </span><span id="MathJax-Span-746" class="msubsup"><span id="MathJax-Span-747" class="mi">b</span><span id="MathJax-Span-748" class="texatom"><span id="MathJax-Span-749" class="mrow"><span id="MathJax-Span-750" class="mo">(</span><span id="MathJax-Span-751" class="mn">1</span><span id="MathJax-Span-752" class="mo">)</span></span></span></span><span id="MathJax-Span-753" class="mtext"> are its parameters.</span></span></span><span id="MathJax-Span-760" class="mtd"><span id="MathJax-Span-761" class="mrow"><span id="MathJax-Span-762" class="mi"></span><span id="MathJax-Span-763" class="mo">[</span><span id="MathJax-Span-764" class="mfrac"><span id="MathJax-Span-765" class="mrow"><span id="MathJax-Span-766" class="mi">∂</span><span id="MathJax-Span-767" class="mi">l</span></span><span id="MathJax-Span-768" class="mrow"><span id="MathJax-Span-769" class="mi">∂</span><span id="MathJax-Span-770" class="mi">x</span></span></span><span id="MathJax-Span-771" class="mo">,</span><span id="MathJax-Span-772" class="mfrac"><span id="MathJax-Span-773" class="mrow"><span id="MathJax-Span-774" class="mi">∂</span><span id="MathJax-Span-775" class="mi">l</span></span><span id="MathJax-Span-776" class="mrow"><span id="MathJax-Span-777" class="mi">∂</span><span id="MathJax-Span-778" class="msubsup"><span id="MathJax-Span-779" class="mi">W</span><span id="MathJax-Span-780" class="texatom"><span id="MathJax-Span-781" class="mrow"><span id="MathJax-Span-782" class="mo">(</span><span id="MathJax-Span-783" class="mn">1</span><span id="MathJax-Span-784" class="mo">)</span></span></span></span></span></span><span id="MathJax-Span-785" class="mo">,</span><span id="MathJax-Span-786" class="mfrac"><span id="MathJax-Span-787" class="mrow"><span id="MathJax-Span-788" class="mi">∂</span><span id="MathJax-Span-789" class="mi">l</span></span><span id="MathJax-Span-790" class="mrow"><span id="MathJax-Span-791" class="mi">∂</span><span id="MathJax-Span-792" class="msubsup"><span id="MathJax-Span-793" class="mi">b</span><span id="MathJax-Span-794" class="texatom"><span id="MathJax-Span-795" class="mrow"><span id="MathJax-Span-796" class="mo">(</span><span id="MathJax-Span-797" class="mn">1</span><span id="MathJax-Span-798" class="mo">)</span></span></span></span></span></span><span id="MathJax-Span-799" class="mo">]</span><span id="MathJax-Span-800" class="mo">=</span><span id="MathJax-Span-801" class="msubsup"><span id="MathJax-Span-802" class="mtext">linear</span><span id="MathJax-Span-803" class="texatom"><span id="MathJax-Span-804" class="mrow"><span id="MathJax-Span-805" class="mo">(</span><span id="MathJax-Span-806" class="mn">1</span><span id="MathJax-Span-807" class="mo">)</span></span></span></span><span id="MathJax-Span-808" class="mtext">.backward</span><span id="MathJax-Span-809" class="mo">(</span><span id="MathJax-Span-810" class="mi">x</span><span id="MathJax-Span-811" class="mo">,</span><span id="MathJax-Span-812" class="mfrac"><span id="MathJax-Span-813" class="mrow"><span id="MathJax-Span-814" class="mi">∂</span><span id="MathJax-Span-815" class="mi">l</span></span><span id="MathJax-Span-816" class="mrow"><span id="MathJax-Span-817" class="mi">∂</span><span id="MathJax-Span-818" class="mi">u</span></span></span><span id="MathJax-Span-819" class="mo">)</span><span id="MathJax-Span-820" class="mo">.</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">forward pass:u=linear(1).forward(x)=W(1)x+b(1),where W(1) and b(1) are its parameters.backward pass:[∂l∂x,∂l∂W(1),∂l∂b(1)]=linear(1).backward(x,∂l∂u).</span></span>

<span id="MathJax-Element-29-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>tanh</mtext></mrow><mo>:</mo><mspace width=&quot;15pt&quot; /></mtd><mtd><mi>h</mi><mo>=</mo><mfrac><mrow><mpadded width=&quot;0&quot; height=&quot;8.6pt&quot; depth=&quot;3pt&quot;><mrow /></mpadded><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></mstyle></mrow><mrow><mpadded width=&quot;0&quot; height=&quot;8.6pt&quot; depth=&quot;3pt&quot;><mrow /></mpadded><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>2</mn><mi>u</mi></mrow></msup></mrow></mstyle></mrow></mfrac><mo>&amp;#x2212;</mo><mn>1</mn></mtd></mtr></mtable></math>"><span id="MathJax-Span-821" class="math"><span id="MathJax-Span-822" class="mrow"><span id="MathJax-Span-823" class="mtable"><span id="MathJax-Span-824" class="mtd"><span id="MathJax-Span-825" class="mrow"><span id="MathJax-Span-826" class="texatom"><span id="MathJax-Span-827" class="mrow"><span id="MathJax-Span-828" class="mtext">tanh</span></span></span><span id="MathJax-Span-829" class="mo">:</span><span id="MathJax-Span-830" class="mspace"></span></span></span><span id="MathJax-Span-831" class="mtd"><span id="MathJax-Span-832" class="mrow"><span id="MathJax-Span-833" class="mi">h</span><span id="MathJax-Span-834" class="mo">=</span><span id="MathJax-Span-835" class="mfrac"><span id="MathJax-Span-836" class="mrow"><span id="MathJax-Span-837" class="mpadded"><span id="MathJax-Span-838" class="mrow"><span id="MathJax-Span-839" class="mrow"></span></span></span><span id="MathJax-Span-840" class="mstyle"><span id="MathJax-Span-841" class="mrow"><span id="MathJax-Span-842" class="texatom"><span id="MathJax-Span-843" class="mrow"><span id="MathJax-Span-844" class="mn">2</span></span></span></span></span></span><span id="MathJax-Span-845" class="mrow"><span id="MathJax-Span-846" class="mpadded"><span id="MathJax-Span-847" class="mrow"><span id="MathJax-Span-848" class="mrow"></span></span></span><span id="MathJax-Span-849" class="mstyle"><span id="MathJax-Span-850" class="mrow"><span id="MathJax-Span-851" class="texatom"><span id="MathJax-Span-852" class="mrow"><span id="MathJax-Span-853" class="mn">1</span><span id="MathJax-Span-854" class="mo">+</span><span id="MathJax-Span-855" class="msubsup"><span id="MathJax-Span-856" class="mi">e</span><span id="MathJax-Span-857" class="texatom"><span id="MathJax-Span-858" class="mrow"><span id="MathJax-Span-859" class="mo">−</span><span id="MathJax-Span-860" class="mn">2</span><span id="MathJax-Span-861" class="mi">u</span></span></span></span></span></span></span></span></span></span><span id="MathJax-Span-862" class="mo">−</span><span id="MathJax-Span-863" class="mn">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">tanh:h=21+e−2u−1</span></span>

<span id="MathJax-Element-30-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>relu</mtext></mrow><mo>:</mo><mspace width=&quot;15pt&quot; /></mtd><mtd><mi>h</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mi>u</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><msub><mi>u</mi><mn>1</mn></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></mtd></mtr><mtr><mtd><mo>&amp;#x22EE;</mo></mtd></mtr><mtr><mtd><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><msub><mi>u</mi><mi>M</mi></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math>"><span id="MathJax-Span-864" class="math"><span id="MathJax-Span-865" class="mrow"><span id="MathJax-Span-866" class="mtable"><span id="MathJax-Span-867" class="mtd"><span id="MathJax-Span-868" class="mrow"><span id="MathJax-Span-869" class="texatom"><span id="MathJax-Span-870" class="mrow"><span id="MathJax-Span-871" class="mtext">relu</span></span></span><span id="MathJax-Span-872" class="mo">:</span><span id="MathJax-Span-873" class="mspace"></span></span></span><span id="MathJax-Span-874" class="mtd"><span id="MathJax-Span-875" class="mrow"><span id="MathJax-Span-876" class="mi">h</span><span id="MathJax-Span-877" class="mo">=</span><span id="MathJax-Span-878" class="mi">m</span><span id="MathJax-Span-879" class="mi">a</span><span id="MathJax-Span-880" class="mi">x</span><span id="MathJax-Span-881" class="mo">{</span><span id="MathJax-Span-882" class="mn">0</span><span id="MathJax-Span-883" class="mo">,</span><span id="MathJax-Span-884" class="mi">u</span><span id="MathJax-Span-885" class="mo">}</span><span id="MathJax-Span-886" class="mo">=</span><span id="MathJax-Span-887" class="mrow"><span id="MathJax-Span-888" class="mo">⎡⎣⎢⎢</span><span id="MathJax-Span-889" class="mtable"><span id="MathJax-Span-890" class="mtd"><span id="MathJax-Span-891" class="mrow"><span id="MathJax-Span-892" class="mo">max</span><span id="MathJax-Span-893" class="mo">{</span><span id="MathJax-Span-894" class="mn">0</span><span id="MathJax-Span-895" class="mo">,</span><span id="MathJax-Span-896" class="msubsup"><span id="MathJax-Span-897" class="mi">u</span><span id="MathJax-Span-898" class="mn">1</span></span><span id="MathJax-Span-899" class="mo">}</span></span></span><span id="MathJax-Span-900" class="mtd"><span id="MathJax-Span-901" class="mrow"><span id="MathJax-Span-902" class="mo">⋮</span></span></span><span id="MathJax-Span-903" class="mtd"><span id="MathJax-Span-904" class="mrow"><span id="MathJax-Span-905" class="mo">max</span><span id="MathJax-Span-906" class="mo">{</span><span id="MathJax-Span-907" class="mn">0</span><span id="MathJax-Span-908" class="mo">,</span><span id="MathJax-Span-909" class="msubsup"><span id="MathJax-Span-910" class="mi">u</span><span id="MathJax-Span-911" class="mi">M</span></span><span id="MathJax-Span-912" class="mo">}</span></span></span></span><span id="MathJax-Span-913" class="mo">⎤⎦⎥⎥</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">relu:h=max{0,u}=[max{0,u1}⋮max{0,uM}]</span></span>

<span id="MathJax-Element-32-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mtext>forward pass:</mtext><mspace width=&quot;2em&quot; /></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi></mrow><mo>=</mo><mtext>dropout</mtext><mtext>.forward</mtext><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi></mrow><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mi>J</mi></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>&amp;#x2212;</mo><mi>r</mi></mrow></mfrac><mo>&amp;#x00D7;</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>1</mtext></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>p</mi><mn>1</mn></msub><mo>&amp;gt;=</mo><mi>r</mi><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x00D7;</mo><msub><mi>q</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>&amp;#x22EE;</mo></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>1</mtext></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>p</mi><mi>J</mi></msub><mo>&amp;gt;=</mo><mi>r</mi><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x00D7;</mo><msub><mi>q</mi><mi>J</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd /></mtr><mtr><mtd /><mtd><mtext>where&amp;#xA0;</mtext><msub><mi>p</mi><mi>j</mi></msub><mtext>&amp;#xA0;is generated randomly from&amp;#xA0;</mtext><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi mathvariant=&quot;normal&quot;>&amp;#x2200;</mi><mi>j</mi><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><mi>J</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mo>,</mo></mtd></mtr><mtr><mtd /><mtd><mtext>and&amp;#xA0;</mtext><mi>r</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;is a pre-defined scalar named dropout rate which is given to you</mtext><mo>.</mo></mtd></mtr></mtable></math>"><span id="MathJax-Span-923" class="math"><span id="MathJax-Span-924" class="mrow"><span id="MathJax-Span-925" class="mtable"><span id="MathJax-Span-926" class="mtd"><span id="MathJax-Span-927" class="mrow"><span id="MathJax-Span-928" class="mtext">forward pass:</span><span id="MathJax-Span-929" class="mspace"></span></span></span><span id="MathJax-Span-997" class="mtd"><span id="MathJax-Span-998" class="mrow"></span></span><span id="MathJax-Span-999" class="mtd"><span id="MathJax-Span-1000" class="mrow"></span></span><span id="MathJax-Span-1025" class="mtd"><span id="MathJax-Span-1026" class="mrow"></span></span><span id="MathJax-Span-930" class="mtd"><span id="MathJax-Span-931" class="mrow"><span id="MathJax-Span-932" class="texatom"><span id="MathJax-Span-933" class="mrow"><span id="MathJax-Span-934" class="mi">s</span></span></span><span id="MathJax-Span-935" class="mo">=</span><span id="MathJax-Span-936" class="mtext">dropout</span><span id="MathJax-Span-937" class="mtext">.forward</span><span id="MathJax-Span-938" class="mo">(</span><span id="MathJax-Span-939" class="texatom"><span id="MathJax-Span-940" class="mrow"><span id="MathJax-Span-941" class="mi">q</span></span></span><span id="MathJax-Span-942" class="mo">∈</span><span id="MathJax-Span-943" class="msubsup"><span id="MathJax-Span-944" class="texatom"><span id="MathJax-Span-945" class="mrow"><span id="MathJax-Span-946" class="mi">R</span></span></span><span id="MathJax-Span-947" class="mi">J</span></span><span id="MathJax-Span-948" class="mo">)</span><span id="MathJax-Span-949" class="mo">=</span><span id="MathJax-Span-950" class="mfrac"><span id="MathJax-Span-951" class="mn">1</span><span id="MathJax-Span-952" class="mrow"><span id="MathJax-Span-953" class="mn">1</span><span id="MathJax-Span-954" class="mo">−</span><span id="MathJax-Span-955" class="mi">r</span></span></span><span id="MathJax-Span-956" class="mo">×</span><span id="MathJax-Span-957" class="mrow"><span id="MathJax-Span-958" class="mo">⎡⎣⎢⎢</span><span id="MathJax-Span-959" class="mtable"><span id="MathJax-Span-960" class="mtd"><span id="MathJax-Span-961" class="mrow"><span id="MathJax-Span-962" class="texatom"><span id="MathJax-Span-963" class="mrow"><span id="MathJax-Span-964" class="mtext">1</span></span></span><span id="MathJax-Span-965" class="mo">[</span><span id="MathJax-Span-966" class="msubsup"><span id="MathJax-Span-967" class="mi">p</span><span id="MathJax-Span-968" class="mn">1</span></span><span id="MathJax-Span-969" class="mo">&gt;=</span><span id="MathJax-Span-970" class="mi">r</span><span id="MathJax-Span-971" class="mo">]</span><span id="MathJax-Span-972" class="mo">×</span><span id="MathJax-Span-973" class="msubsup"><span id="MathJax-Span-974" class="mi">q</span><span id="MathJax-Span-975" class="mn">1</span></span></span></span><span id="MathJax-Span-976" class="mtd"><span id="MathJax-Span-977" class="mrow"><span id="MathJax-Span-978" class="mo">⋮</span></span></span><span id="MathJax-Span-979" class="mtd"><span id="MathJax-Span-980" class="mrow"><span id="MathJax-Span-981" class="texatom"><span id="MathJax-Span-982" class="mrow"><span id="MathJax-Span-983" class="mtext">1</span></span></span><span id="MathJax-Span-984" class="mo">[</span><span id="MathJax-Span-985" class="msubsup"><span id="MathJax-Span-986" class="mi">p</span><span id="MathJax-Span-987" class="mi">J</span></span><span id="MathJax-Span-988" class="mo">&gt;=</span><span id="MathJax-Span-989" class="mi">r</span><span id="MathJax-Span-990" class="mo">]</span><span id="MathJax-Span-991" class="mo">×</span><span id="MathJax-Span-992" class="msubsup"><span id="MathJax-Span-993" class="mi">q</span><span id="MathJax-Span-994" class="mi">J</span></span></span></span></span><span id="MathJax-Span-995" class="mo">⎤⎦⎥⎥</span></span><span id="MathJax-Span-996" class="mo">,</span></span></span><span id="MathJax-Span-1001" class="mtd"><span id="MathJax-Span-1002" class="mrow"><span id="MathJax-Span-1003" class="mtext">where </span><span id="MathJax-Span-1004" class="msubsup"><span id="MathJax-Span-1005" class="mi">p</span><span id="MathJax-Span-1006" class="mi">j</span></span><span id="MathJax-Span-1007" class="mtext"> is generated randomly from </span><span id="MathJax-Span-1008" class="mo">[</span><span id="MathJax-Span-1009" class="mn">0</span><span id="MathJax-Span-1010" class="mo">,</span><span id="MathJax-Span-1011" class="mn">1</span><span id="MathJax-Span-1012" class="mo">)</span><span id="MathJax-Span-1013" class="mo">,</span><span id="MathJax-Span-1014" class="mi">∀</span><span id="MathJax-Span-1015" class="mi">j</span><span id="MathJax-Span-1016" class="mo">∈</span><span id="MathJax-Span-1017" class="mo">{</span><span id="MathJax-Span-1018" class="mn">1</span><span id="MathJax-Span-1019" class="mo">,</span><span id="MathJax-Span-1020" class="mo">⋯</span><span id="MathJax-Span-1021" class="mo">,</span><span id="MathJax-Span-1022" class="mi">J</span><span id="MathJax-Span-1023" class="mo">}</span><span id="MathJax-Span-1024" class="mo">,</span></span></span><span id="MathJax-Span-1027" class="mtd"><span id="MathJax-Span-1028" class="mrow"><span id="MathJax-Span-1029" class="mtext">and </span><span id="MathJax-Span-1030" class="mi">r</span><span id="MathJax-Span-1031" class="mo">∈</span><span id="MathJax-Span-1032" class="mo">[</span><span id="MathJax-Span-1033" class="mn">0</span><span id="MathJax-Span-1034" class="mo">,</span><span id="MathJax-Span-1035" class="mn">1</span><span id="MathJax-Span-1036" class="mo">)</span><span id="MathJax-Span-1037" class="mtext"> is a pre-defined scalar named dropout rate which is given to you</span><span id="MathJax-Span-1038" class="mo">.</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">forward pass:s=dropout.forward(q∈RJ)=11−r×[1[p1&gt;=r]×q1⋮1[pJ&gt;=r]×qJ],where pj is generated randomly from [0,1),∀j∈{1,⋯,J},and r∈[0,1) is a pre-defined scalar named dropout rate which is given to you.</span></span>